% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nfsa_write_excel_template_T0801.R
\name{nfsa_write_excel_template_T0801}
\alias{nfsa_write_excel_template_T0801}
\title{Create NFSA Excel template T0801}
\usage{
nfsa_write_excel_template_T0801(
  data,
  template = here::here("assets", "template_T0801.xlsx"),
  output_sel = here::here("output", "excel_template")
)
}
\arguments{
\item{data}{A data frame containing at least the columns
\code{id}, \code{ref_area}, \code{time_period}, and \code{obs_value}. The \code{id} column must
encode \code{ref_sector}, \code{sto}, and \code{accounting_entry} separated by dots
(for example, \code{"S1.A.B"}).}

\item{template}{Path to the Excel template file to use for
table T0801. Defaults to \code{here("assets", "template_T0801.xlsx")}.}

\item{output_sel}{Path to the output directory where the generated
Excel file will be saved. Defaults to
\code{here("output", "excel_template")}.}
}
\value{
Invisibly returns the \code{Workbook} object (from \code{openxlsx}) after the
data have been written and the file has been created.
}
\description{
Generate an Excel file for table T0801 by reshaping NFSA data and
writing it into a predefined Excel template.
}
\details{
The function splits the \code{id} column into NFSA components, filters
valid reference sectors and time periods, reshapes identifiers, and
writes the resulting data to the \code{data} sheet of the template before
saving a timestamped copy in the selected output directory.

The function:
\itemize{
\item Splits \code{id} into \code{ref_sector}, \code{sto}, and \code{accounting_entry}.
\item Keeps only selected NFSA reference sectors and observations from
1999-Q1 onwards.
\item Rebuilds a compact \code{id} by combining period, reference area,
and NFSA identifier and writes this to the \code{data} sheet in the template,
starting at cell A1.
}

The output file name follows the pattern
\code{"T0801_<country>_<YYYYMMDD_HHMMSS>.xlsx"}, where \verb{<country>} must be
available in the calling environment.
}
\examples{
\dontrun{
library(tidyverse)
library(here)
library(openxlsx)

# Example input data
example_data <- tibble::tibble(
  id          = c("S1.A.B", "S11.C.D"),
  ref_area    = c("EA", "EA"),
  time_period = c("1999-Q1", "2000-Q2"),
  obs_value   = c(100, 200)
)

country <- "EA"
nfsa_write_excel_template_T0801(
  data     = example_data,
  template = here::here("assets", "template_T0801.xlsx"),
  output_sel = here::here("output", "excel_template")
)
}

}
\seealso{
\code{\link[openxlsx]{loadWorkbook}},
\code{\link[openxlsx]{writeData}},
\code{\link[openxlsx]{saveWorkbook}} for manipulating Excel workbooks.
}
