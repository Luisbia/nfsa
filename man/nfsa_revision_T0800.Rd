% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nfsa_revision_T0800.R
\name{nfsa_revision_T0800}
\alias{nfsa_revision_T0800}
\title{Identify and Report Revisions in T0800 Data}
\usage{
nfsa_revision_T0800(
  country,
  abs_threshold = 100,
  rel_threshold = 0,
  output_sel = here("output", "revisions")
)
}
\arguments{
\item{country}{A character vector specifying the country or countries to analyze.
This should correspond to the country codes used in the input file names.}

\item{abs_threshold}{A numeric value specifying the minimum absolute revision value to consider.
Revisions with an absolute value less than this threshold will be filtered out. Defaults to 100.}

\item{rel_threshold}{A numeric value specifying the minimum relative revision value (as a percentage of GDP) to consider.
Revisions with an absolute relative value less than this threshold will be filtered out. Defaults to 0.}

\item{output_sel}{A character string specifying the path to the directory where the output Excel file will be saved.
Defaults to \code{here("output", "revisions")}.}
}
\value{
This function does not return a value, but saves an Excel file containing the identified revisions to the specified output directory.
The file name includes a timestamp and the country code (if a single country is selected).  If no revisions meet the threshold criteria, a message will be displayed in the console.
}
\description{
This function identifies and reports revisions between two versions of T0800 data.
It compares the \code{obs_value} in the new and previous datasets, calculates the absolute and
relative revisions, and filters the results based on specified thresholds.
}
\details{
The function performs the following steps:
\enumerate{
\item Loads the new and previous T0800 data files from the specified directories. The function extracts the version and country code from the filenames.
\item Cleans and transforms the data, including joining with a lookup table (\code{nfsa::nfsa_sto_lookup}),
separating the \code{id} column into \code{ref_sector}, \code{sto}, and \code{accounting_entry}, and removing rows with missing values.
\item Calculates the absolute revision (\code{rev}) as the difference between the new and previous \code{obs_value}.
\item Calculates the relative revision (\code{revp}) as the percentage change relative to the previous \code{obs_value}.
\item Calculates the revision as a percentage of GDP (\code{as_GDP}).
\item Filters the revisions based on the specified \code{abs_threshold} and \code{rel_threshold}.
\item Saves the filtered revisions to an Excel file in the specified output directory.
}
}
\examples{
\dontrun{
# Example usage with default thresholds and file paths:
nfsa_revision_T0800(country = "BE")

# Example usage with custom thresholds:
nfsa_revision_T0800(country = c("IT", "ES"),
                     abs_threshold = 50,
                     rel_threshold = 0.5,
                     output_sel = here("path", "to", "output"))
}

}
