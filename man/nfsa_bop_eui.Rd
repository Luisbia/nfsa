% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nfsa_bop_eui.R
\name{nfsa_bop_eui}
\alias{nfsa_bop_eui}
\title{Extract and Process Balance of Payments (BOP) Data for the Euro Area}
\usage{
nfsa_bop_eui(output_sel)
}
\arguments{
\item{output_sel}{A character string specifying the directory where the output Excel file
should be saved.}
}
\value{
A list containing six data frames: REC_S1, REC_S12, REC_S13 (credits for sectors S1,
S12, and S13, respectively), and PAY_S1, PAY_S12, PAY_S13 (debits for sectors S1, S12, and
S13, respectively).  Each data frame contains time series data with BOP items as columns and
time periods as rows. Monetary values are expressed in millions of euros.
}
\description{
This function extracts quarterly and annual Balance of Payments (BOP) data
from Eurostat for the EU INstitutions (EUI), processes it, and saves it to an Excel file.
It focuses on transactions related to sectors S1 (Total Economy), S12 (Financial Corporations),
and S13 (Government). The function retrieves data for both credits and debits, and performs
some data imputation for earlier periods where sectoral data is unavailable.
}
\details{
The function uses the \code{restatapi} package to retrieve data from Eurostat and the
\code{tidyverse} package for data manipulation. It also uses \code{openxlsx} to write the output to
an Excel file. The function performs the following steps:
\enumerate{
\item Downloads annual and quarterly BOP data from Eurostat for the Euro Area.
\item Filters the data to include only sectors S1, S12, and S13, and transactions with the
rest of the world.
\item Converts credits and debits to a common representation ('C' and 'D', respectively).
\item Imputes missing sectoral data for earlier periods (1999-Q1 to 2007-Q4) by distributing
total economy (S1) data to sectors S12 and S13 based on their relative shares in later
periods.
\item Pivots the data to create data frames with BOP items as columns and time periods as rows.
\item Converts the monetary values to millions of euros.
\item Saves the resulting data frames to an Excel file in the specified output directory.
}
}
\examples{
\dontrun{
# Example usage: Save the output to a directory named "output" in the current working directory.
output_dir <- file.path(getwd(), "output")
if (!dir.exists(output_dir)) {
  dir.create(output_dir)
}
result <- nfsa_bop_eui(output_dir)

# The result is a list of six data frames containing the processed BOP data.
# The data is also saved to an Excel file in the specified output directory.
}

}
